<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>~/.vim/doc_origin_b/pi_getscript.cnx.html</title>
<meta name="Generator" content="Vim/7.4">
<meta name="plugin-version" content="vim7.4_v1">
<meta name="syntax" content="help">
<meta name="settings" content="use_css,pre_wrap,no_foldcolumn,prevent_copy=">
<meta name="colorscheme" content="none">
<style type="text/css">
<!--
pre { white-space: pre-wrap; font-family: monospace; color: #000000; background-color: #ffffff; }
body { font-family: monospace; color: #000000; background-color: #ffffff; }
* { font-size: 1em; }
.Comment { color: #0000c0; }
.Constant { color: #c00000; }
.Todo { color: #000000; background-color: #ffff00; padding-bottom: 1px; }
.Identifier { color: #008080; }
.Statement { color: #af5f00; }
.PreProc { color: #c000c0; }
.Folded { color: #0000c0; background-color: #a8a8a8; padding-bottom: 1px; }
-->
</style>

<script type='text/javascript'>
<!--

-->
</script>
</head>
<body>
<pre id='vimCodeElement'>
<span class="Constant">pi_getscript.txt</span>  For <span class="Identifier">Vim version 7.3.</span>  最近更新: 2010年5月

<span class="Comment">		GETSCRIPT 参考手册 作者: Charles E. Campbell, Jr.</span>
				<span class="Identifier">译者</span>: Willis
				<span class="Constant"><a href="http://vimcdoc.sf.net">http://vimcdoc.sf.net</a></span>

Authors:  Charles E. Campbell, Jr.  &lt;NdrOchip@ScampbellPfamilyA.Mbiz&gt;
	  (remove NOSPAM from the email address)
						<span class="Constant">GetLatestVimScripts-copyright</span>
Copyright: (c) 2004-2009 by Charles E. Campbell, Jr.	<span class="Constant">glvs-copyright</span>
           The VIM LICENSE applies to getscript.vim and
           pi_getscript.txt (see <span class="Identifier">copyright</span>) except use
           &quot;getscript&quot; instead of &quot;Vim&quot;.  No warranty, express or implied.
	   Use At-Your-Own-Risk.

getscript 是一个插件，它简化了获取你自己使用的脚本的最新版本的步骤！输入
<span class="Identifier">:GLVS</span> 会启动 getscript；它会接着使用 &lt;GetLatestVimScripts.dat&gt; 文件 (见
<span class="Identifier">GetLatestVimScripts_dat</span>) 来从 http//vim.sf.net/ 得到该文件列出的脚本的最新
版本。

<span class="PreProc">==============================================================================</span>
1. 内容					<span class="Constant">glvs-contents</span> <span class="Constant">glvs</span> <span class="Constant">getscript</span>
<span class="Statement">   					</span><span class="Constant">GetLatestVimScripts</span>

	1. 内容...........................................: <span class="Identifier">glvs-contents</span>
	2. GetLatestVimScripts -- 入门....................: <span class="Identifier">glvs-install</span>
	3. GetLatestVimScripts 用法.......................: <span class="Identifier">glvs-usage</span>
	4. GetLatestVimScripts 数据文件...................: <span class="Identifier">glvs-data</span>
	5. GetLatestVimScripts 友好插件...................: <span class="Identifier">glvs-plugins</span>
	6. GetLatestVimScripts 自动安装...................: <span class="Identifier">glvs-autoinstall</span>
	7. GetLatestViMScripts 选项.......................: <span class="Identifier">glvs-options</span>
	8. GetLatestVimScripts 算法.......................: <span class="Identifier">glvs-alg</span>
	9. GetLatestVimScripts 历史.......................: <span class="Identifier">glvs-hist</span>


<span class="PreProc">==============================================================================</span>
2. GetLatestVimScripts -- 入门				<span class="Constant">getscript-start</span>
						<span class="Constant">getlatestvimscripts-install</span>

	VIM 发 布 提 供 的 版 本			<span class="Constant">glvs-dist-install</span>

Vim 7.0 没有包含 GetLatestVimScripts.dist 文件，该文件提供了示例和样板。所以，
你需要自己建立一个。参见 <span class="Identifier">GetLatestVimScripts_dat</span>。

	VIM SF NET 提 供 的 版 本			<span class="Constant">glvs-install</span>

<span class="Todo">备注</span>: 最后一步，即为 GetLatestVimScripts.dist 文件换名或移动，适用于那些第一次
刚刚下载 GetLatestVimScripts.tar.bz2 的用户。

GetLatestVimScripts.dist 文件提供了示例和样板，你可以参照来建立自己的列表。你
尽可以删掉所有那里提到的所有脚本，&quot;紧要的&quot; 部分是头两行。

你的计算机需要带有 wget 或 curl，这样 GetLatestVimScripts 才能工作。

	1. 如果经过压缩:  gunzip getscript.vba.gz
	2. Unix:
		vim getscript.vba
		:so %
		:q
		cd ~/.vim/GetLatest
		mv GetLatestVimScripts.dist GetLatestVimScripts.dat
		(编辑 GetLatestVimScripts.dat，以安装你自己需要的插件列表 --
		见 <span class="Identifier">GetLatestVimScripts_dat</span>)

	3. Windows:
		vim getscript.vba
		:so %
		:q
		cd **path-to-vimfiles**/GetLatest
		mv GetLatestVimScripts.dist GetLatestVimScripts.dat
		(编辑 GetLatestVimScripts.dat，以安装你自己需要的插件列表 --
		见 <span class="Identifier">GetLatestVimScripts_dat</span>)


<span class="PreProc">==============================================================================</span>
3. GetLatestVimScripts 用法				<span class="Constant">glvs-usage</span> <span class="Constant">:GLVS</span>

除非另有定义，
<span class="Comment">	:GLVS</span>
会调用 GetLatestVimScripts()。如果其它脚本定义了该命令，那么你可以输入

<span class="Comment">	:GetLatestVimScripts</span>

该脚本试图从  <span class="Constant"><a href="http://vim.sourceforge.net/">http://vim.sourceforge.net/</a></span> 更新并，如果允许，为你自动安装脚本。
为此它会审视如下文件

<span class="Comment">	.vim/GetLatest/GetLatestVimScripts.dat                    (unix)</span>

或
<span class="Comment">	..wherever..\vimfiles\GetLatest\GetLatestVimScripts.dat   (windows)</span>
(见 <span class="Identifier">glvs-data</span>) 并检查 [.vim|vimfiles]/plugin 目录里的插件 (见
<span class="Identifier">glvs-plugins</span>)。

下载的脚本会出现在 ~/.vim/GetLatest (unix) 或 ..wherever..\vimfiles\GetLatest
(windows) 子目录。如果 &lt;.vimrc&gt; 里包含以下的行，GetLatestVimScripts 会尝试自动
安装它们:

<span class="Comment">	let g:GetLatestVimScripts_allowautoinstall=1</span>

GetLatestVimScripts.dat&gt; 文件会自动更新，以反映脚本的最新下载版本。(也见
<span class="Identifier">glvs-options</span>)


<span class="PreProc">==============================================================================</span>
4. GetLatestVimScripts 数据文件			<span class="Constant">getscript-data</span> <span class="Constant">glvs-data</span>
<span class="Statement"> 						</span><span class="Constant">:GetLatestVimScripts_dat</span>
数据文件 &lt;GetLatestVimScripts.dat&gt; 开始的两行必须包含下面的文字:

<span class="Comment">	ScriptID SourceID Filename</span>
<span class="Comment">	--------------------------</span>

这两行之后的内容包含三列数据，前两列是数值列，然后是一列文本列。
GetLatest/GetLatestVimScripts.dist 文件包含了这样的数据文件的一个示例。任何
#... 之后的内容都被忽略，以便你在文件中嵌入注释。

每行第一个数值给出脚本的 ScriptID。如果用浏览器察看 <span class="Constant"><a href="http://vim.sf.net/">http://vim.sf.net/</a></span> 里的脚
本，点击脚本的链接之前，你会看到该链接的形式如下:

	<span class="Constant"><a href="http://vim.sourceforge.net/scripts/script.php?script_id=40">http://vim.sourceforge.net/scripts/script.php?script_id=40</a></span>

这里 &quot;40&quot; 就是 ScriptID，GetLatestVimScripts 用它来下载相关页面。

每行第二个数值给出脚本的 SourceID。SourceID 记录由 vim.sf.net 决定的脚本上传次
数；这样，它起到了指示脚本 &quot;何时&quot; 上传的作用。设置 SourceID 为 1 就可使
GetLatestVimScripts 认为它拥有的脚本版本已经过时。

GetLatestVimScripts 从 vim.sf.net 的相应脚本页提取 SourceID。一旦该值大于
GetLatestVimScripts.dat 文件保存的值，该脚本就会被下载 (见
<span class="Identifier">GetLatestVimScripts_dat</span>)。

如果脚本作者在脚本中包含了某特殊注释行，GetLatestVimScripts 会用该脚本本身和
(如果存在的话) 它依赖的其它脚本来构造 &lt;GetLatestVimScripts.dat&gt; 文件。例如，考
虑:

<span class="Comment">	&quot; GetLatestVimScripts: 884  1 :AutoInstall: AutoAlign.vim</span>

该注释行告诉 getscript.vim 检查 #884 vim 脚本，并且说明该脚本可自动安装。
Getscript 也会使用该行来帮助构造 GetLatestVimScripts.dat 文件，如果该文件中还
没有包含 AutoAlign.vim 的行的话，在其中加入这样的行:

<span class="Comment">	884 1 AutoAlign.vim</span>

详见 <span class="Identifier">glvs-plugins</span>。这样，GetLatestVimScripts 提供了全面的让你脚本随时保持更
新的完整功能！

						<span class="Constant">GetLatestVimScripts_dat</span>
一个 &lt;GetLatestVimScripts.dat&gt; 文件的示例:

<span class="Comment">    ScriptID SourceID Filename</span>
<span class="Comment">    --------------------------</span>
<span class="Comment">    294 1 Align.vim</span>
<span class="Comment">    120 2 decho.vim</span>
<span class="Comment">     40 3 DrawIt.tar.gz</span>
<span class="Comment">    451 4 EasyAccents.vim</span>
<span class="Comment">    195 5 engspchk.vim</span>
<span class="Comment">    642 6 GetLatestVimScripts.vim</span>
<span class="Comment">    489 7 Manpageview.vim</span>

<span class="Todo">备注</span>: 必须提供开始的两行，但它们基本上只起注释的作用。

<span class="PreProc">==============================================================================</span>
5. GetLatestVimScripts 友好插件		<span class="Constant">getscript-plugins</span> <span class="Constant">glvs-plugins</span>

		<span class="PreProc">(这一节适用于插件作者们)</span>

如果插件作者在插件的任何地方包含了下面形式的注释，GetLatestVimScripts 会找到它
并用来构造用户 GetLatestVimScripts.dat 文件:

<span class="Comment">				 src_id</span>
<span class="Comment">				    v</span>
<span class="Comment">	&quot; GetLatestVimScripts: ### ### yourscriptname</span>
<span class="Comment">				^</span>
<span class="Comment">			    scriptid</span>

作为作者，加上该行就可以引用你自己的脚本，如果需要，也可以附加注释行来描述依赖
的其它脚本。当然，使用相同格式！

多数脚本都可以自动安装。如果你的命令也可以 (见 <span class="Identifier">glvs-autoinstall</span>)，那么可在
&quot;yourscriptname&quot; 开始的位置之前加上 :AutoInstall:。

<span class="Comment">	                         src_id</span>
<span class="Comment">	                            v</span>
<span class="Comment">	&quot; GetLatestVimScripts: ### ### :AutoInstall: yourscriptname</span>
<span class="Comment">	                        ^</span>
<span class="Comment">	                    scriptid</span>

<span class="Todo">备注</span><span class="PreProc">: :AutoInstall: 是插件作者的选项，不是 GetLatestVimScripts.dat 的项目！</span>

如果还没有加入的话，此时就会在用户 GetLatest/GetLatestVimScripts.dat 文件里加
入这些脚本的 GetLatestVimScript 命令。这是一个相对简单的自动获取所有你的插件所
依赖的脚本的方法。

不过，作为作者，你可能不想让 GetLatestVimScripts 下载你自己的脚本，因为这样会
覆盖你还没有发布的工作。GetLatestVimScripts 提供了解决这个问题的方法:  把

<span class="Comment">	0 0 yourscriptname</span>

放入 &lt;GetLatestVimScripts.dat&gt; 文件。这样 GetLatestVimScripts 就会跳过
&quot;yourscriptname&quot; 脚本的 GetLatestVimScript 注释行检查。从而，这些行就不会加到
&lt;GetLatestVimScripts.dat&gt; 文件里并进而下载你自己的脚本。如果包含了
:AutoInstall: 选项，这一点尤其重要。

确定 &quot;0 0 yourscriptname&quot; 用的 &quot;yourscriptname&quot; 和 GetLatestVimScript 注释里的
相同！


<span class="PreProc">==============================================================================</span>
6. GetLatestVimScripts 自动安装				<span class="Constant">getscript-autoinstall</span>
							<span class="Constant">glvs-autoinstall</span>

GetLatestVimScripts 现在支持了 &quot;AutoInstall&quot; (自动安装)。并非所有脚本都支持自
动安装。若干脚本或有特殊的安装需求 (请参阅这些脚本的 &quot;install&quot; (安装) 指示)。
换一角度讲，可以自动安装的脚本还是占多数的。

要让 GetLatestVimScripts 进行自动安装，数据文件的注释域须以下列文字开始 (前后
有空白无妨):

<span class="Comment">	:AutoInstall:</span>

必须给出前后两个冒号，也必须放在注释 (yourscriptname) 域的开始处。

如果你不想进行任何自动安装，在 &lt;.vimrc&gt; 里放入:

<span class="Comment">	let g:GetLatestVimScripts_allowautoinstall= 0</span>

缺省打开 :AutoInstall:。此时，名字里包含如下后缀的文件会被相应地

	---.tar.bz2  : 解压和 untar 解包到 .vim /目录
	---.vba.bz2  : 解压到 .vim/ 目录，然后由 vimball 处理
	---.vim.bz2  : 解压并移到 .vim/plugin 目录
	---.tar.gz   : 解压和 untar 解包到 .vim/ 目录
	---.vba.gz   : 解压到 .vim/ 目录，然后由 vimball 处理
	---.vim.gz   : 解压并移到 .vim/plugin 目录
	---.vba      : 解压到 .vim/ 目录
	---.vim      : 移到 .vim/plugin 目录
	---.zip      : unzip 解压到 .vim/ 目录

如果只要通过 untar/gunzip 或 &quot;移到插件目录&quot; 过程来放置各个部件就可以使用，那么
这个脚本就称之为可以自动安装。当然，Vimball 包总是可以自动安装的。

什么时候脚本不能自动安装？让我举个例子:

<span class="Comment">	[.vim|vimfiles]/after/syntax/blockhl.vim</span>

&lt;blockhl.vim&gt; 脚本提供 C/C++ 程序的块高亮；它可以这样得到:

	<span class="Constant"><a href="http://vim.sourceforge.net/scripts/script.php?script_id=104">http://vim.sourceforge.net/scripts/script.php?script_id=104</a></span>

目前，vim 的 after/syntax 只支持按文件类型命名的脚本 (blockhl.vim 的情况应该使
用 after/syntax/c.vim)。所以，如果使用自动安装，可能会覆盖当前用户自己的
after/syntax/c.vim 文件。

我自己的例子。我用 &lt;aftersyntax.vim&gt; (换名到 after/syntax/c.vim) 以支持
after/syntax/c/ 目录:

	<span class="Constant"><a href="http://vim.sourceforge.net/scripts/script.php?script_id=1023">http://vim.sourceforge.net/scripts/script.php?script_id=1023</a></span>

该脚本允许多个语法文件在 after/syntax/c 子目录同时存在。我不能把
aftersyntax.vim 捆绑进来并构造一个合适的自动安装用 tar 包，因为它包含的
after/syntax/c.vim 可能会覆盖用户自己的 c.vim。


<span class="PreProc">==============================================================================</span>
7. GetLatestVimScripts 选项					<span class="Constant">glvs-options</span>

<span class="Comment">	g:GetLatestVimScripts_wget</span>
	缺省= &quot;wget&quot;
		该变量记住获取脚本命令名。

<span class="Comment">	g:GetLatestVimScripts_options</span>
	缺省= &quot;-q -O&quot;
		该变量记住用于 g:GetLatestVimScripts_wget 命令的选项。

<span class="Comment"> 	g:GetLatestVimScripts_allowautoinstall</span>
	缺省= 1
		该变量指示是否允许 GetLatestVimScripts 尝试自动安装脚本。更进
		一步地，插件作者必须显式地指明他/她的插件是否可以自动安装 (通
		过 GetLatestVimScripts 注释行的 :AutoInstall: 关键字)。

<span class="Comment">	g:GetLatestVimScripts_autoinstalldir</span>
	缺省= $HOME/.vim     (linux)
	缺省= $HOME/vimfiles (windows)
		覆盖 :AutoInstall: 脚本安装的位置。不用于覆盖 vimball 安装的位
		置。

<span class="PreProc">==============================================================================</span>
8. GetLatestVimScripts 算法			<span class="Constant">glvs-algorithm</span> <span class="Constant">glvs-alg</span>

Vim sourceforge 页面用所谓的 script-id 键动态建立页面。以下网页

	<span class="Constant"><a href="http://vim.sourceforge.net/scripts/script.php?script_id=40">http://vim.sourceforge.net/scripts/script.php?script_id=40</a></span>

指定最新的 source-id (src_id)。该源标识符 (source-id) 总是不断递增，因此如果
src_id 大于 GetLatestVimScripts 脚本记录的值，那就是时候下载该脚本的新版本了。

此时，GetLatestVimScripts 下载脚本并更新内部数据库里的 script id、 source id
和 scriptname。

然后，AutoInstall 过程会:

	从 GetLatest/ 把文件移动到下面的目录
		Unix   : $HOME/.vim
		Windows: $HOME\vimfiles
	如果下载文件以 &quot;.bz2&quot; 结尾
		进行 bunzip2 解压
	否则如果下载文件以 &quot;.gz&quot; 结尾
		进行 gunzip 解压
	如果产生的文件以 &quot;.zip&quot; 结尾
		进行 unzip 解压
	否则如果产生的文件以 &quot;.tar&quot; 结尾
		进行 tar -oxvf 解包
	否则如果产生的文件以 &quot;.vim&quot; 结尾
		把它移动到 plugin 子目录


<span class="PreProc">==============================================================================</span>
<span class="Folded">+-- 84 行: 9. GetLatestVimScripts 历史 (英文) *getscript-history* *glvs-hist* </span>
</pre>
</body>
</html>
<!-- vim: set foldmethod=manual : -->
